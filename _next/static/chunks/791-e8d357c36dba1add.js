"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[791],{6617:function(e,t,s){s.d(t,{default:function(){return f}});var a=s(8980),r=s(2208),n=s(9014),l=s(9211),o=s(738),i=s(9603),c=s(2886),m=s(5999),d=s(1474),u=s(1285),h=s(6199),x=s(1294);function y(e){let{isOpen:t,onClose:s,searchQuery:n,onQueryChange:l,placeholder:o="Search hymns..."}=e,[i,c]=(0,r.useState)([]),[d,u]=(0,r.useState)(!1),h=(0,r.useRef)(null),y=async e=>{if(!e.trim()){c([]);return}u(!0);try{let t=await fetch((0,x.kG)("/api/search?q=".concat(encodeURIComponent(e),"&limit=5")));if(!t.ok)throw Error("Search failed");let s=(await t.json()).map(e=>({id:e.hymn.id,title:e.hymn.title,hymnal:e.hymnal.abbreviation,number:e.hymn.number,url:"/".concat(e.hymnal.url_slug,"/hymn-").concat(e.hymn.number,"-").concat(e.hymn.title.toLowerCase().replace(/[^\w\s-]/g,"").replace(/\s+/g,"-"))}));c(s)}catch(e){console.error("Search error:",e),c([])}finally{u(!1)}};(0,r.useEffect)(()=>{let e=setTimeout(()=>{n&&t?y(n):c([])},300);return()=>clearTimeout(e)},[n,t]),(0,r.useEffect)(()=>{let e=e=>{h.current&&!h.current.contains(e.target)&&s()};if(t)return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[t,s]);let f=e=>{window.location.href=e.url,s()},g=e=>{e.preventDefault(),n.trim()&&(window.location.href="/search?q=".concat(encodeURIComponent(n.trim())))};return t?(0,a.jsx)("div",{ref:h,className:"absolute top-full left-0 right-0 mt-2 bg-white rounded-lg shadow-lg border border-gray-200 z-50 max-h-80 overflow-y-auto",children:(0,a.jsxs)("div",{className:"p-4",children:[d&&(0,a.jsxs)("div",{className:"text-center py-4 text-gray-500",children:[(0,a.jsx)("div",{className:"animate-spin h-5 w-5 mx-auto border-2 border-primary-500 border-t-transparent rounded-full"}),(0,a.jsx)("p",{className:"mt-2 text-sm",children:"Searching..."})]}),!d&&n&&0===i.length&&(0,a.jsxs)("div",{className:"text-center py-4 text-gray-500",children:[(0,a.jsxs)("p",{className:"text-sm",children:['No results found for "',n,'"']}),(0,a.jsx)("button",{onClick:g,className:"mt-2 text-sm text-primary-600 hover:text-primary-700 font-medium",children:"Search all hymns →"})]}),!d&&i.length>0&&(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsxs)("div",{className:"text-xs text-gray-500 mb-2",children:["Found ",i.length," result",1!==i.length?"s":""]}),i.map(e=>(0,a.jsx)("button",{onClick:()=>f(e),className:"w-full text-left p-2 rounded hover:bg-gray-50 transition-colors",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("h4",{className:"text-sm font-medium text-gray-900 truncate",children:e.title}),(0,a.jsxs)("div",{className:"text-xs text-gray-500 mt-0.5",children:[e.hymnal," #",e.number]})]}),(0,a.jsx)(m.Z,{className:"h-4 w-4 text-gray-400 ml-2 flex-shrink-0"})]})},e.id)),(0,a.jsx)("div",{className:"border-t border-gray-200 pt-2 mt-2",children:(0,a.jsx)("button",{onClick:g,className:"w-full text-left p-2 rounded hover:bg-gray-50 transition-colors",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("span",{className:"text-sm text-primary-600 font-medium",children:['Search all hymns for "',n,'"']}),(0,a.jsx)("span",{className:"text-xs text-gray-400",children:"→"})]})})})]}),!n&&(0,a.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,a.jsx)(m.Z,{className:"mx-auto h-8 w-8 mb-2 text-gray-300"}),(0,a.jsx)("p",{className:"text-sm",children:"Start typing to search hymns..."})]})]})}):null}function f(e){let{hymnalReferences:t}=e,[s,f]=(0,r.useState)(!1),[g,p]=(0,r.useState)(!1),[b,v]=(0,r.useState)(!1),[j,N]=(0,r.useState)(!1),[w,_]=(0,r.useState)(""),[C,k]=(0,r.useState)(""),[S,E]=(0,r.useState)(t),[L,Z]=(0,r.useState)(!1),z=(0,l.usePathname)();(0,r.useEffect)(()=>{f(!1),p(!1),v(!1),N(!1),k("")},[z]),(0,r.useEffect)(()=>{if(t){E(t);return}S||L||(Z(!0),(async()=>{try{let e=await fetch((0,x.kG)("/api/hymnals"));if(!e.ok)throw Error("Failed to load hymnal references");let t=await e.json();E(t)}catch(e){console.error("Failed to load hymnal references:",e),E({hymnals:{},languages:{},metadata:{total_hymnals:0,date_range:{earliest:2e3,latest:2024},languages_supported:[],total_estimated_songs:0,source:"API Error",generated_date:new Date().toISOString().split("T")[0]}})}finally{Z(!1)}})())},[t,S,L]),(0,r.useEffect)(()=>(s?document.body.style.overflow="hidden":document.body.style.overflow="unset",()=>{document.body.style.overflow="unset"}),[s]),(0,r.useEffect)(()=>{let e=e=>{let t=e.target;t.closest(".hymnal-dropdown-container")||(p(!1),k("")),t.closest(".search-dropdown-container")||v(!1)};return document.addEventListener("click",e),()=>document.removeEventListener("click",e)},[]);let H=[{name:"Home",href:"/",current:"/"===z},{name:"Search",href:"/search",current:"/search"===z},{name:"Download",href:"/download",current:"/download"===z},{name:"About",href:"/about",current:"/about"===z},{name:"Contribute",href:"/contribute",current:"/contribute"===z}],A=[{name:"Seventh-day Adventist Hymnal",url_slug:"seventh-day-adventist-hymnal"},{name:"Christ in Song",url_slug:"christ-in-song"},{name:"Church Hymnal",url_slug:"church-hymnal"},{name:"Nyimbo za Kristo",url_slug:"nyimbo-za-kristo"},{name:"Wende Nyasaye",url_slug:"wende-nyasaye"},{name:"View All Collections",url_slug:"hymnals"}],F=t||S,I=F?Object.values(F.hymnals):[];I.length>0?I.map(e=>({name:e.site_name||e.name,url_slug:e.url_slug})):A.slice(0,-1);let O=I.length>0?I.filter(e=>{var t;if(!e.url_slug)return!1;if(!C.trim())return!0;let s=C.toLowerCase();return e.name.toLowerCase().includes(s)||(null===(t=e.site_name)||void 0===t?void 0:t.toLowerCase().includes(s))||e.abbreviation.toLowerCase().includes(s)||e.language_name.toLowerCase().includes(s)||e.year.toString().includes(s)}).sort((e,t)=>t.year-e.year):A.filter(e=>!C.trim()||e.name.toLowerCase().includes(C.toLowerCase())),D=e=>{e.preventDefault(),w.trim()&&(window.location.href="/search?q=".concat(encodeURIComponent(w.trim())))};return(0,a.jsx)("header",{className:"bg-white shadow-sm border-b border-gray-200 sticky top-0 z-50",children:(0,a.jsxs)("nav",{className:"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8","aria-label":"Top",children:[(0,a.jsxs)("div",{className:"flex h-16 items-center justify-between",children:[(0,a.jsx)("div",{className:"flex items-center",children:(0,a.jsxs)(n.default,{href:"/",className:"flex items-center space-x-2",children:[(0,a.jsx)(o.Z,{className:"h-8 w-8 text-primary-600"}),(0,a.jsx)("div",{className:"text-xl font-bold text-gray-900",children:"Advent Hymnals"})]})}),(0,a.jsxs)("div",{className:"hidden lg:flex lg:items-center lg:space-x-8",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-8",children:[H.map(e=>(0,a.jsx)(n.default,{href:e.href,className:(0,h.classNames)(e.current?"text-primary-600 font-medium":"text-gray-700 hover:text-primary-600","text-sm font-medium transition-colors duration-200"),children:e.name},e.name)),(0,a.jsxs)("div",{className:"relative hymnal-dropdown-container",children:[(0,a.jsxs)("button",{onClick:e=>{e.stopPropagation(),p(!g)},className:(0,h.classNames)(z.includes("/seventh-day-adventist-hymnal")||z.includes("/christ-in-song")||z.includes("/church-hymnal")||z.includes("/nyimbo-za-kristo")?"text-primary-600 font-medium":"text-gray-700 hover:text-primary-600","flex items-center space-x-1 text-sm font-medium transition-colors duration-200"),children:[(0,a.jsx)(i.Z,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:"Hymnals"}),(0,a.jsx)(c.Z,{className:"h-4 w-4"})]}),g&&(0,a.jsx)("div",{className:"absolute left-0 mt-2 w-80 bg-white rounded-lg shadow-lg border border-gray-200 z-50",children:(0,a.jsxs)("div",{className:"p-3 flex flex-col max-h-96",children:[(0,a.jsxs)("div",{className:"relative mb-3 flex-shrink-0",children:[(0,a.jsx)(m.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),(0,a.jsx)("input",{type:"text",value:C,onChange:e=>k(e.target.value),placeholder:"Search hymnals...",className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-primary-500 focus:border-transparent outline-none",onClick:e=>e.stopPropagation()})]}),(0,a.jsx)("div",{className:"flex-1 overflow-y-auto space-y-1 min-h-0 custom-scrollbar",children:O.length>0?O.map(e=>(0,a.jsx)(n.default,{href:"/".concat(e.url_slug),className:"block p-2 rounded-md hover:bg-gray-50 transition-colors duration-200",onClick:()=>{p(!1),k("")},children:(0,a.jsx)("div",{className:"flex items-center justify-between",children:(0,a.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,a.jsx)("div",{className:"text-sm font-medium text-gray-900 truncate",children:e.site_name||e.name}),e.year&&e.total_songs&&(0,a.jsxs)("div",{className:"text-xs text-gray-500",children:[e.year," • ",e.total_songs," hymns • ",e.language_name]})]})})},e.url_slug)):(0,a.jsx)("div",{className:"text-center py-4 text-gray-500",children:(0,a.jsx)("p",{className:"text-sm",children:"No hymnals found"})})}),(0,a.jsx)("div",{className:"mt-3 pt-3 border-t border-gray-200 flex-shrink-0",children:(0,a.jsxs)(n.default,{href:"/hymnals",className:"text-sm text-primary-600 hover:text-primary-700 font-medium",onClick:()=>{p(!1),k("")},children:["View all ",I.length>0?I.length:A.length-1," collections →"]})})]})})]})]}),(0,a.jsxs)("div",{className:"relative search-dropdown-container",children:[(0,a.jsx)("form",{onSubmit:D,className:"flex items-center",children:(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("input",{type:"text",value:w,onChange:e=>_(e.target.value),onFocus:()=>v(!0),placeholder:"Search hymns...",className:"w-64 pl-10 pr-4 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-primary-500 focus:border-transparent outline-none"}),(0,a.jsx)(m.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"})]})}),(0,a.jsx)(y,{isOpen:b,onClose:()=>v(!1),searchQuery:w,onQueryChange:_})]})]}),(0,a.jsx)("div",{className:"lg:hidden",children:(0,a.jsxs)("button",{type:"button",className:"inline-flex items-center justify-center rounded-md p-2 text-gray-700 hover:bg-gray-100 hover:text-gray-900 focus:outline-none focus:ring-2 focus:ring-primary-500",onClick:()=>f(!s),children:[(0,a.jsx)("span",{className:"sr-only",children:"Open main menu"}),s?(0,a.jsx)(d.Z,{className:"block h-6 w-6","aria-hidden":"true"}):(0,a.jsx)(u.Z,{className:"block h-6 w-6","aria-hidden":"true"})]})})]}),s&&(0,a.jsx)("div",{className:"lg:hidden border-t border-gray-200 bg-white fixed inset-x-0 top-16 bottom-0 z-40 overflow-y-auto",children:(0,a.jsxs)("div",{className:"space-y-1 px-2 pb-3 pt-2 min-h-full bg-white",children:[(0,a.jsxs)("div",{className:"mb-4 relative",children:[(0,a.jsx)("form",{onSubmit:D,children:(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("input",{type:"text",value:w,onChange:e=>_(e.target.value),onFocus:()=>N(!0),placeholder:"Search hymns...",className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-primary-500 focus:border-transparent outline-none"}),(0,a.jsx)(m.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"})]})}),(0,a.jsx)(y,{isOpen:j,onClose:()=>N(!1),searchQuery:w,onQueryChange:_})]}),H.map(e=>(0,a.jsx)(n.default,{href:e.href,className:(0,h.classNames)(e.current?"bg-primary-50 text-primary-600 font-medium":"text-gray-700 hover:bg-gray-50 hover:text-gray-900","block px-3 py-2 rounded-md text-base font-medium"),children:e.name},e.name)),(0,a.jsxs)("div",{className:"pt-4 border-t border-gray-200",children:[(0,a.jsx)("div",{className:"text-sm font-medium text-gray-900 px-3 py-2",children:"Hymnal Collections"}),O.slice(0,5).map(e=>(0,a.jsxs)(n.default,{href:"/".concat(e.url_slug),className:"block px-3 py-2 text-sm text-gray-700 hover:bg-gray-50 hover:text-gray-900",children:[(0,a.jsx)("div",{className:"font-medium",children:e.site_name||e.name}),e.year&&e.total_songs&&(0,a.jsxs)("div",{className:"text-xs text-gray-500",children:[e.year," • ",e.total_songs," hymns"]})]},e.url_slug)),(0,a.jsxs)(n.default,{href:"/hymnals",className:"block px-3 py-2 text-sm text-primary-600 hover:text-primary-700 font-medium",children:["View all ",I.length," collections →"]})]})]})})]})})}}}]);