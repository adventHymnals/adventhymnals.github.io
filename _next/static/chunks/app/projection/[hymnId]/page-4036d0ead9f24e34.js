(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[58],{3168:function(e,t,s){Promise.resolve().then(s.bind(s,8044))},8044:function(e,t,s){"use strict";s.d(t,{default:function(){return v}});var l=s(8980),a=s(2208),n=s(9211),r=s(6199),i=s(1294),c=s(2424),o=s(3367),d=s(8967);let u=a.forwardRef(function(e,t){let{title:s,titleId:l,...n}=e;return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":l},n),s?a.createElement("title",{id:l},s):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.879 7.519c1.171-1.025 3.071-1.025 4.242 0 1.172 1.025 1.172 2.687 0 3.712-.203.179-.43.326-.67.442-.745.361-1.45.999-1.45 1.827v.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9 5.25h.008v.008H12v-.008Z"}))}),m=a.forwardRef(function(e,t){let{title:s,titleId:l,...n}=e;return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":l},n),s?a.createElement("title",{id:l},s):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8.25 6.75h12M8.25 12h12m-12 5.25h12M3.75 6.75h.007v.008H3.75V6.75Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0ZM3.75 12h.007v.008H3.75V12Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm-.375 5.25h.007v.008H3.75v-.008Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Z"}))});var h=s(1474),x=s(5999);let g={showVerseNumbers:!0,showChorusAfterEachVerse:!0,fontSize:"large",theme:"light",showMetadata:!0,autoAdvance:!1};function v(e){let{hymnId:t,hymn:v}=e,f=(0,n.useSearchParams)(),b=(0,n.useRouter)(),[y,p]=(0,a.useState)(v),[w,j]=(0,a.useState)([]),[k,N]=(0,a.useState)(0),[E,C]=(0,a.useState)(g),[S,F]=(0,a.useState)(!0),[L,A]=(0,a.useState)(!1),[Z,M]=(0,a.useState)(!1),[R,D]=(0,a.useState)(!1),[H,T]=(0,a.useState)(null),[I,z]=(0,a.useState)([]),[q,O]=(0,a.useState)(""),[P,V]=(0,a.useState)(!v);(0,a.useEffect)(()=>{let e=async()=>{try{document.fullscreenElement||(await document.documentElement.requestFullscreen(),D(!0))}catch(e){console.warn("Could not enter fullscreen:",e);try{let e=document.documentElement;e.webkitRequestFullscreen?(await e.webkitRequestFullscreen(),D(!0)):e.mozRequestFullScreen?(await e.mozRequestFullScreen(),D(!0)):e.msRequestFullscreen&&(await e.msRequestFullscreen(),D(!0))}catch(e){console.warn("Fallback fullscreen also failed:",e)}}},t=()=>{document.fullscreenElement||e(),document.removeEventListener("click",t)};return e().catch(()=>{console.log("Waiting for user interaction to enter fullscreen..."),document.addEventListener("click",t)}),()=>{document.removeEventListener("click",t)}},[]),(0,a.useEffect)(()=>{(async()=>{if(!y){V(!0);try{let{loadHymn:e}=await Promise.resolve().then(s.bind(s,1294)),l=await e(t);l&&p(l)}catch(e){console.error("Failed to load hymn:",e)}finally{V(!1)}}})()},[t,y]),(0,a.useEffect)(()=>{(async()=>{try{let e=t.split("-")[0],s=(await (0,i.Cv)()).hymnals[e];if(s){T(s);let t=await (0,i.Q3)(e,1,1e3);z(t.hymns)}}catch(e){console.error("Failed to load data:",e)}})()},[t]),(0,a.useEffect)(()=>{let e=f.get("settings");if(e)try{let t=JSON.parse(e);C({...g,...t})}catch(e){console.error("Failed to parse settings:",e)}let t=f.get("slide");if(t){let e=parseInt(t,10);isNaN(e)||N(e)}},[f]),(0,a.useEffect)(()=>{y&&j((0,r.generateProjectionSlides)(y,E))},[y,E]);let W=(0,a.useCallback)(()=>{N(e=>e<w.length-1?e+1:e)},[w.length]);(0,a.useEffect)(()=>{if(E.autoAdvance&&E.autoAdvanceDelay){let e=setTimeout(()=>{W()},1e3*E.autoAdvanceDelay);return()=>{e&&clearTimeout(e)}}},[k,E.autoAdvance,E.autoAdvanceDelay,W]);let B=(0,a.useCallback)(()=>{N(e=>e>0?e-1:e)},[]),_=(0,a.useCallback)(e=>{e>=0&&e<w.length&&N(e)},[w.length]),J=(0,a.useCallback)(()=>{N(0)},[]),K=(0,a.useCallback)(()=>{N(w.length-1)},[w.length]),U=(0,a.useCallback)(()=>{document.fullscreenElement?(document.exitFullscreen(),D(!1)):(document.documentElement.requestFullscreen(),D(!0))},[]),Q=(0,a.useCallback)(e=>{let t=encodeURIComponent(JSON.stringify(E));b.push("/projection/".concat(e,"?settings=").concat(t)),M(!1)},[b,E]),X=I.filter(e=>{var t,s;return(null===(t=e.title)||void 0===t?void 0:t.toLowerCase().includes(q.toLowerCase()))||(null===(s=e.id)||void 0===s?void 0:s.toLowerCase().includes(q.toLowerCase()))});if((0,a.useEffect)(()=>{let e=e=>{var t,s,l;let a=(null===(t=e.target)||void 0===t?void 0:t.tagName)==="INPUT",n=(null===(s=e.target)||void 0===s?void 0:s.tagName)==="TEXTAREA",r=(null===(l=e.target)||void 0===l?void 0:l.contentEditable)==="true";if(!Z&&!L&&!a&&!n&&!r)switch(e.key){case" ":case"ArrowRight":e.preventDefault(),W();break;case"ArrowLeft":case"Backspace":e.preventDefault(),B();break;case"Home":e.preventDefault(),J();break;case"End":e.preventDefault(),K();break;case"f":case"F":e.preventDefault(),U();break;case"Escape":e.preventDefault(),R?(document.exitFullscreen(),D(!1)):window.close();break;case"h":case"H":case"?":e.preventDefault(),A(!L);break;case"i":case"I":e.preventDefault(),M(!Z);break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":e.preventDefault();let i=parseInt(e.key),c=w.findIndex(e=>"verse"===e.type&&e.number===i);-1!==c&&_(c);break;case"c":case"C":e.preventDefault();let o=w.findIndex(e=>"chorus"===e.type);-1!==o&&_(o)}};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[W,B,J,K,U,R,L,Z,w,_]),(0,a.useEffect)(()=>{let e;let t=()=>{F(!0),clearTimeout(e),e=setTimeout(()=>F(!1),3e3)},s=()=>t(),l=()=>t();return window.addEventListener("mousemove",s),window.addEventListener("click",l),t(),()=>{window.removeEventListener("mousemove",s),window.removeEventListener("click",l),clearTimeout(e)}},[]),P||!y||0===w.length)return(0,l.jsx)("div",{className:"min-h-screen bg-gray-900 flex items-center justify-center",children:(0,l.jsxs)("div",{className:"text-white text-center",children:[(0,l.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-white mx-auto mb-4"}),(0,l.jsx)("p",{children:"Loading hymn..."})]})});let G=w[k],Y=(0,r.getProjectionThemeClasses)(E.theme),$=(0,r.getFontSizeClasses)(E.fontSize),ee=(0,r.formatSlideContent)(G,E);return(0,l.jsxs)("div",{className:(0,c.A)("min-h-screen flex flex-col relative",Y.container),children:[(0,l.jsx)("div",{className:"absolute top-4 left-4 opacity-40 text-sm",children:(0,l.jsxs)("div",{className:(0,c.A)("font-bold px-3 py-1 rounded-lg","light"===E.theme?"bg-gray-200 text-gray-700":"bg-gray-800 text-gray-300"),children:["Key: ",y.key||"C Major"]})}),(0,l.jsx)("div",{className:"absolute bottom-4 right-4 opacity-30 text-xs",children:(0,l.jsx)("div",{className:(0,c.A)("font-medium","light"===E.theme?"text-gray-500":"text-gray-400"),children:"Advent Hymnals"})}),(0,l.jsx)("div",{className:"flex-1 flex items-center justify-center p-8",children:(0,l.jsxs)("div",{className:"text-center max-w-6xl w-full",children:["title"===G.type&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("h1",{className:(0,c.A)("font-bold mb-8",$,Y.text),children:y.title}),E.showMetadata&&(0,l.jsxs)("div",{className:(0,c.A)("text-2xl md:text-3xl lg:text-4xl space-y-2","light"===E.theme?"text-gray-600":"text-gray-300"),children:[y.author&&(0,l.jsxs)("div",{children:["Words: ",y.author]}),y.composer&&(0,l.jsxs)("div",{children:["Music: ",y.composer]}),y.tune&&(0,l.jsxs)("div",{children:["Tune: ",y.tune]}),y.key&&(0,l.jsxs)("div",{children:["Key: ",y.key]}),y.meter&&(0,l.jsxs)("div",{children:["Meter: ",y.meter]})]})]}),("verse"===G.type||"chorus"===G.type)&&(0,l.jsxs)(l.Fragment,{children:["verse"===G.type&&E.showVerseNumbers&&(0,l.jsxs)("div",{className:(0,c.A)("text-xl md:text-2xl lg:text-3xl mb-4 font-semibold","light"===E.theme?"text-gray-600":"text-gray-300"),children:["Verse ",G.number]}),"chorus"===G.type&&(0,l.jsx)("div",{className:(0,c.A)("text-xl md:text-2xl lg:text-3xl mb-4 font-semibold","light"===E.theme?"text-gray-600":"text-gray-300"),children:"Chorus"}),(0,l.jsx)("div",{className:(0,c.A)("leading-relaxed whitespace-pre-line",$,Y.text),children:ee})]}),"metadata"===G.type&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("h2",{className:(0,c.A)("text-3xl md:text-4xl lg:text-5xl font-semibold mb-8",Y.text),children:"Hymn Information"}),(0,l.jsx)("div",{className:(0,c.A)("text-xl md:text-2xl lg:text-3xl leading-relaxed whitespace-pre-line",Y.text),children:ee})]})]})}),(0,l.jsx)("div",{className:(0,c.A)("absolute bottom-0 left-0 right-0 p-4 transition-opacity duration-300",S?"opacity-100":"opacity-0 pointer-events-none"),children:(0,l.jsxs)("div",{className:"flex items-center justify-between bg-black bg-opacity-75 rounded-lg p-4",children:[(0,l.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,l.jsx)("button",{onClick:B,disabled:0===k,className:"p-2 text-white hover:bg-white hover:bg-opacity-20 rounded-lg disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:(0,l.jsx)(o.Z,{className:"h-6 w-6"})}),(0,l.jsxs)("div",{className:"text-white text-sm",children:[k+1," / ",w.length]}),(0,l.jsx)("button",{onClick:W,disabled:k===w.length-1,className:"p-2 text-white hover:bg-white hover:bg-opacity-20 rounded-lg disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:(0,l.jsx)(d.Z,{className:"h-6 w-6"})})]}),(0,l.jsx)("div",{className:"text-white text-sm font-medium",children:(0,r.getSlideTitle)(G)}),(0,l.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,l.jsx)("button",{onClick:()=>A(!0),className:"p-2 text-white hover:bg-white hover:bg-opacity-20 rounded-lg transition-colors",title:"Help",children:(0,l.jsx)(u,{className:"h-6 w-6"})}),(0,l.jsx)("button",{onClick:()=>M(!0),className:"p-2 text-white hover:bg-white hover:bg-opacity-20 rounded-lg transition-colors",title:"Hymn Index (I)",children:(0,l.jsx)(m,{className:"h-6 w-6"})}),(0,l.jsx)("button",{onClick:U,className:"p-2 text-white hover:bg-white hover:bg-opacity-20 rounded-lg transition-colors",title:"Toggle Fullscreen (F)",children:(0,l.jsx)("svg",{className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5l-5-5m5 5v-4m0 4h-4"})})}),(0,l.jsx)("button",{onClick:()=>window.close(),className:"p-2 text-white hover:bg-white hover:bg-opacity-20 rounded-lg transition-colors",title:"Close",children:(0,l.jsx)(h.Z,{className:"h-6 w-6"})})]})]})}),L&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-75 z-50",onClick:()=>A(!1)}),(0,l.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:(0,l.jsx)("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full",children:(0,l.jsxs)("div",{className:"p-6",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,l.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Keyboard Shortcuts"}),(0,l.jsx)("button",{onClick:()=>A(!1),className:"text-gray-400 hover:text-gray-600",children:(0,l.jsx)(h.Z,{className:"h-6 w-6"})})]}),(0,l.jsx)("div",{className:"space-y-2",children:[{key:"Space/→",description:"Next slide"},{key:"←/Backspace",description:"Previous slide"},{key:"Home",description:"First slide"},{key:"End",description:"Last slide"},{key:"F",description:"Toggle fullscreen"},{key:"I",description:"Show hymn index"},{key:"H/?",description:"Show help"},{key:"Esc",description:"Exit fullscreen/Close"},{key:"1-9",description:"Jump to verse"},{key:"C",description:"Jump to chorus"}].map((e,t)=>(0,l.jsxs)("div",{className:"flex justify-between",children:[(0,l.jsx)("span",{className:"font-mono text-sm bg-gray-100 px-2 py-1 rounded",children:e.key}),(0,l.jsx)("span",{className:"text-sm text-gray-600",children:e.description})]},t))})]})})})]}),Z&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-75 z-50",onClick:()=>M(!1)}),(0,l.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:(0,l.jsxs)("div",{className:"bg-white rounded-lg shadow-xl max-w-4xl w-full max-h-[80vh] flex flex-col",children:[(0,l.jsxs)("div",{className:"p-6 border-b",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,l.jsxs)("h3",{className:"text-xl font-semibold text-gray-900",children:[(null==H?void 0:H.name)||"Hymnal"," - Select Hymn"]}),(0,l.jsx)("button",{onClick:()=>M(!1),className:"text-gray-400 hover:text-gray-600",children:(0,l.jsx)(h.Z,{className:"h-6 w-6"})})]}),(0,l.jsxs)("div",{className:"relative",children:[(0,l.jsx)(x.Z,{className:"h-5 w-5 absolute left-3 top-3 text-gray-400"}),(0,l.jsx)("input",{type:"text",placeholder:"Search hymns...",value:q,onChange:e=>O(e.target.value),onKeyDown:e=>{"Enter"===e.key&&X.length>0&&Q(X[0].id)},className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-gray-900 bg-white",autoFocus:!0})]})]}),(0,l.jsx)("div",{className:"flex-1 overflow-y-auto p-6",children:(0,l.jsxs)("div",{className:"grid gap-2",children:[X.slice(0,100).map(e=>(0,l.jsxs)("button",{onClick:()=>Q(e.id),className:"p-3 text-left rounded-lg border transition-colors hover:bg-blue-50 hover:border-blue-300 ".concat(e.id===t?"bg-blue-100 border-blue-500":"bg-gray-50 border-gray-200"),children:[(0,l.jsxs)("div",{className:"font-medium text-gray-900",children:[e.number?"".concat(e.number,". "):"",e.title]}),e.author&&(0,l.jsx)("div",{className:"text-sm text-gray-600 mt-1",children:e.author})]},e.id)),0===X.length&&(0,l.jsx)("div",{className:"text-center py-8 text-gray-500",children:"No hymns found matching your search."}),X.length>100&&(0,l.jsx)("div",{className:"text-center py-4 text-gray-500",children:"Showing first 100 results. Refine your search to see more."})]})}),(0,l.jsx)("div",{className:"p-6 border-t bg-gray-50 text-sm text-gray-600",children:(0,l.jsxs)("div",{className:"flex justify-between items-center",children:[(0,l.jsxs)("span",{children:["Press ",(0,l.jsx)("kbd",{className:"bg-white px-2 py-1 rounded border",children:"I"})," to toggle this index"]}),(0,l.jsxs)("span",{children:[X.length," hymns available"]})]})})]})})]})]})}},2424:function(e,t,s){"use strict";s.d(t,{A:function(){return n}});var l=s(2240),a=s(3946);function n(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,a.m6)((0,l.W)(t))}},3367:function(e,t,s){"use strict";var l=s(2208);let a=l.forwardRef(function(e,t){let{title:s,titleId:a,...n}=e;return l.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":a},n),s?l.createElement("title",{id:a},s):null,l.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 19.5 8.25 12l7.5-7.5"}))});t.Z=a},8967:function(e,t,s){"use strict";var l=s(2208);let a=l.forwardRef(function(e,t){let{title:s,titleId:a,...n}=e;return l.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":a},n),s?l.createElement("title",{id:a},s):null,l.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m8.25 4.5 7.5 7.5-7.5 7.5"}))});t.Z=a}},function(e){e.O(0,[391,222,14,512,744],function(){return e(e.s=3168)}),_N_E=e.O()}]);